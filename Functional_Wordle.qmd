---
title: "Functional Wordle"
format: html
editor: visual
---

```{r}


load_dictionary <- function(filename){
  if(filename== "valid"){
    dictionary <- readLines("valid.txt")
  } else if (filename== "solution") {
    dictionary <- readLines("solution.txt")
  } else {stop("Wrong File")}
  dictionary <- dictionary[dictionary != ""]
  return(dictionary)
}

valid_list <- load_dictionary("valid")
solution_list <- load_dictionary("solution")

solution_list <- intersect(solution_list, valid_list)

pick_solution <- function(solution_list){
  five_letter <- solution_list[nchar(solution_list)==5]
  choice <- sample(five_letter, 1)
  sep_letters <- strsplit(choice, split = "") [[1]]  
  return(sep_letters)
}

solution <- pick_solution(solution_list)

 evaluate_guess <- function(guess, solution){
    feedback <- character(5)
    for(i in 1:5){
      if(guess[i] == solution[i]){
        feedback[i] <- "green"
      } else if(guess[i] %in% solution){
        feedback[i] <- "yellow"
      } else{
        feedback[i] <- "grey"
      }
    }
    return(feedback)
 }
 
 play_wordle <- function(solution, valid_list, num_guesses=6){
  print("You have", num_guesses, "chances to guess a 5-letter word.")
  print("After each guess, you will receive feedback:")
  print("- Green: Correct letter and correct position.")
  print("- Yellow: Correct letter but wrong position.")
  print("- Grey: Incorrect letter.\n")
  
  remaining_letters <- LETTERS
  guess_history <- list()
  
 
  
  for(guess_num in 1:num_guesses){
    print(paste("\nAttempt", guess_num, "of", num_guesses))
    print(paste("Remaining letters:", paste(remaining_letters, collapse = " ")))
    guess <- readline(prompt = "Enter your guess:")
    guess <- strsplit(guess, split = "")[[1]]
    
    if(length(guess) !=5 || !(paste(guess, collapse = "") %in% valid_list)){
      print("Invalid guess! Please enter a 5-letter word.")
      next
    }
    
    remaining_letters <-setdiff(remaining_letters, guess)
    
    feedback <- evaluate_guess(guess, solution)
    print(paste("Feedback: ", paste(feedback, collapse = " ")))
    
    guess_history[[guess_num]] <-list(guess= paste(guess, collapse = ""), feedback=feedback)
    
    if (paste(guess, collapse = "") == paste(solution, collapse = "")){
      print("Congratulations! You Won!")
      for(i in 1:guess_num){
        print(paste("Guess", i, ":", guess_history[[i]]$guess, "Feedback:", paste(guess_history[[i]]$feedback, collapse = " ")))
      }
      return(invisible())
    }
  }
  print(paste("\nSorry, you are out of guesses. The word was:", paste(solution, collapse = "")))
  print("Your guesses and feedback:")
  for(i in 1:num_guesses){
    print(paste("Guess", i, ":", guess_history[[i]]$guess, "Feedback:", paste(guess_history[[i]]$feedback, collapse = " ")))
  }
}

 
```
